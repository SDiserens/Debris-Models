module US76_PATRIUS

! MODULES
use KINDS, only: dk

implicit none
private

! Earth radius from [1] [km]
real(dk),parameter  ::  AE            = 6356.766_dk

! Layer altitudes [km]
real(dk),parameter  ::  zLayer_86km   = 86._dk
real(dk),parameter  ::  zLayer_91km   = 91._dk
real(dk),parameter  ::  zLayer_110km  = 110._dk
real(dk),parameter  ::  zLayer_120km  = 120._dk

! Layer temperatures [K]
real(dk),parameter  ::  temp_86km    = 186.946_dk
real(dk),parameter  ::  temp_91km    = 186.8673_dk
real(dk),parameter  ::  temp_110km   = 240._dk
real(dk),parameter  ::  temp_120km   = 360._dk
real(dk),parameter  ::  temp_1000km  = 1000._dk

! Constants for the temperature computation in layer B (91km <= z <= 110km)
real(dk),parameter  ::  pta = -19.9429_dk   ! [km]
real(dk),parameter  ::  tc  = 263.1905_dk   ! [K]
real(dk),parameter  ::  gda = -76.3232_dk   ! [K]

! Positive gradient in layer C (110km <= z <= 120km)
real(dk),parameter  ::  dt_110km = 12._dk   ! [K/km]

! Constants for the exponential layer D (z >= 120km)
real(dk),parameter  ::  rlambda = 0.01875_dk

! Molar masses of N2, O, O2, Ar, He, H [g/mol]
real(dk),parameter  ::  molmass(1:7) = [&
 &0._dk, 28.0134_dk, 15.9994_dk, 31.9988_dk, 39.948_dk, 4.0026_dk, 1.0080_dk]

! Boltzmann's constant [Nm/K]
real(dk),parameter  ::  boltz = 1.380622e-23_dk

! Ideal gas constant [(N*m)/(kmol*K)]
real(dk),parameter  ::  rstar = 8314.32_dk

! Number density of atmospheric components as a function of altitude:
! z [km], N2 [m^-3], O [m^-3], O2 [m^-3], Ar [m^-3], He [m^-3], H [m^-3]
real(dk),parameter  ::  nAtmo(1:7,1:430) = reshape([&
    &86.0_dk,1.130e20_dk,8.600e16_dk,3.031e19_dk,1.351e18_dk,7.582e14_dk,0._dk,&
    &86.5_dk,1.034e20_dk,9.939e16_dk,2.772e19_dk,1.236e18_dk,6.976e14_dk,0._dk,&
    &87.0_dk,9.456e19_dk,1.147e17_dk,2.535e19_dk,1.130e18_dk,6.422e14_dk,0._dk,&
    &87.5_dk,8.651e19_dk,1.320e17_dk,2.319e19_dk,1.033e18_dk,5.915e14_dk,0._dk,&
    &88.0_dk,7.915e19_dk,1.513e17_dk,2.120e19_dk,9.437e17_dk,5.453e14_dk,0._dk,&
    &88.5_dk,7.242e19_dk,1.724e17_dk,1.938e19_dk,8.624e17_dk,5.031e14_dk,0._dk,&
    &89.0_dk,6.626e19_dk,1.952e17_dk,1.772e19_dk,7.880e17_dk,4.647e14_dk,0._dk,&
    &89.5_dk,6.062e19_dk,2.193e17_dk,1.619e19_dk,7.198e17_dk,4.296e14_dk,0._dk,&
    &90.0_dk,5.547e19_dk,2.443e17_dk,1.479e19_dk,6.574e17_dk,3.976e14_dk,0._dk,&
                                                               
    &90.5_dk,5.075e19_dk,2.699e17_dk,1.351e19_dk,6.002e17_dk,3.685e14_dk,0._dk,& 
    &91.0_dk,4.643e19_dk,2.953e17_dk,1.234e19_dk,5.478e17_dk,3.419e14_dk,0._dk,& 
    &91.5_dk,4.248e19_dk,3.200e17_dk,1.126e19_dk,4.998e17_dk,3.177e14_dk,0._dk,& 
    &92.0_dk,3.886e19_dk,3.434e17_dk,1.027e19_dk,4.557e17_dk,2.956e14_dk,0._dk,& 
    &92.5_dk,3.553e19_dk,3.651e17_dk,9.361e18_dk,4.152e17_dk,2.753e14_dk,0._dk,& 
    &93.0_dk,3.249e19_dk,3.846e17_dk,8.527e18_dk,3.781e17_dk,2.568e14_dk,0._dk,& 
    &93.5_dk,2.970e19_dk,4.016e17_dk,7.761e18_dk,3.441e17_dk,2.399e14_dk,0._dk,& 
    &94.0_dk,2.715e19_dk,4.159e17_dk,7.060e18_dk,3.129e17_dk,2.244e14_dk,0._dk,& 
    &94.5_dk,2.481e19_dk,4.275e17_dk,6.418e18_dk,2.844e17_dk,2.103e14_dk,0._dk,&
                                                              
    &95.0_dk,2.268e19_dk,4.365e17_dk,5.830e18_dk,2.583e17_dk,1.973e14_dk,0._dk,&
    &95.5_dk,2.072e19_dk,4.429e17_dk,5.293e18_dk,2.345e17_dk,1.854e14_dk,0._dk,&
    &96.0_dk,1.894e19_dk,4.471e17_dk,4.801e18_dk,2.127e17_dk,1.745e14_dk,0._dk,&
    &96.5_dk,1.730e19_dk,4.493e17_dk,4.353e18_dk,1.928e17_dk,1.645e14_dk,0._dk,&
    &97.0_dk,1.581e19_dk,4.500e17_dk,3.943e18_dk,1.746e17_dk,1.553e14_dk,0._dk,&
    &97.5_dk,1.445e19_dk,4.494e17_dk,3.570e18_dk,1.581e17_dk,1.468e14_dk,0._dk,&
    &98.0_dk,1.320e19_dk,4.476e17_dk,3.230e18_dk,1.430e17_dk,1.390e14_dk,0._dk,&
    &98.5_dk,1.206e19_dk,4.447e17_dk,2.920e18_dk,1.292e17_dk,1.317e14_dk,0._dk,&
    &99.0_dk,1.102e19_dk,4.408e17_dk,2.639e18_dk,1.167e17_dk,1.251e14_dk,0._dk,&
    &99.5_dk,1.008e19_dk,4.358e17_dk,2.383e18_dk,1.053e17_dk,1.190e14_dk,0._dk,&
    &100.0_dk,9.210e18_dk,4.298e17_dk,2.151e18_dk,9.501e16_dk,1.133e14_dk,0._dk,&
                                                              
    &101.0_dk,7.740e18_dk,4.168e17_dk,1.756e18_dk,7.735e16_dk,1.034e14_dk,0._dk,&
    &102.0_dk,6.508e18_dk,4.007e17_dk,1.430e18_dk,6.279e16_dk,9.497e13_dk,0._dk,&
    &103.0_dk,5.475e18_dk,3.821e17_dk,1.163e18_dk,5.082e16_dk,8.776e13_dk,0._dk,&
    &104.0_dk,4.609e18_dk,3.619e17_dk,9.434e17_dk,4.101e16_dk,8.160e13_dk,0._dk,&
    &105.0_dk,3.883e18_dk,3.406e17_dk,7.645e17_dk,3.299e16_dk,7.633e13_dk,0._dk,&
    &106.0_dk,3.273e18_dk,3.188e17_dk,6.189e17_dk,2.645e16_dk,7.181e13_dk,0._dk,&
    &107.0_dk,2.760e18_dk,2.968e17_dk,5.005e17_dk,2.113e16_dk,6.789e13_dk,0._dk,&
    &108.0_dk,2.327e18_dk,2.748e17_dk,4.045e17_dk,1.681e16_dk,6.443e13_dk,0._dk,&
    &109.0_dk,1.959e18_dk,2.528e17_dk,3.263e17_dk,1.331e16_dk,6.128e13_dk,0._dk,&
    &110.0_dk,1.641e18_dk,2.303e17_dk,2.621e17_dk,1.046e16_dk,5.821e13_dk,0._dk,&
                                                              
    &111.0_dk,1.373e18_dk,2.083e17_dk,2.104e17_dk,8.200e15_dk,5.526e13_dk,0._dk,&
    &112.0_dk,1.158e18_dk,1.889e17_dk,1.706e17_dk,6.481e15_dk,5.271e13_dk,0._dk,&
    &113.0_dk,9.841e17_dk,1.718e17_dk,1.398e17_dk,5.169e15_dk,5.044e13_dk,0._dk,&
    &114.0_dk,8.422e17_dk,1.565e17_dk,1.156e17_dk,4.162e15_dk,4.838e13_dk,0._dk,&
    &115.0_dk,7.254e17_dk,1.428e17_dk,9.646e16_dk,3.386e15_dk,4.648e13_dk,0._dk,&
    &116.0_dk,6.285e17_dk,1.305e17_dk,8.120e16_dk,2.779e15_dk,4.473e13_dk,0._dk,&
    &117.0_dk,5.475e17_dk,1.194e17_dk,6.891e16_dk,2.301e15_dk,4.310e13_dk,0._dk,&
    &118.0_dk,4.794e17_dk,1.096e17_dk,5.892e16_dk,1.920e15_dk,4.160e13_dk,0._dk,&
    &119.0_dk,4.217e17_dk,1.007e17_dk,5.072e16_dk,1.614e15_dk,4.019e13_dk,0._dk,&
    &120.0_dk,3.726e17_dk,9.275e16_dk,4.395e16_dk,1.366e15_dk,3.888e13_dk,0._dk,&
                                                               
    &121.0_dk,3.306e17_dk,8.562e16_dk,3.832e16_dk,1.164e15_dk,3.766e13_dk,0._dk,&
    &122.0_dk,2.947e17_dk,7.925e16_dk,3.360e16_dk,9.979e14_dk,3.652e13_dk,0._dk,&
    &123.0_dk,2.637e17_dk,7.354e16_dk,2.963e16_dk,8.606e14_dk,3.547e13_dk,0._dk,&
    &124.0_dk,2.368e17_dk,6.840e16_dk,2.625e16_dk,7.460e14_dk,3.448e13_dk,0._dk,&
    &125.0_dk,2.135e17_dk,6.376e16_dk,2.336e16_dk,6.498e14_dk,3.356e13_dk,0._dk,&
    &126.0_dk,1.930e17_dk,5.956e16_dk,2.087e16_dk,5.685e14_dk,3.270e13_dk,0._dk,&
    &127.0_dk,1.750e17_dk,5.576e16_dk,1.871e16_dk,4.994e14_dk,3.189e13_dk,0._dk,&
    &128.0_dk,1.592e17_dk,5.229e16_dk,1.683e16_dk,4.403e14_dk,3.112e13_dk,0._dk,&
    &129.0_dk,1.451e17_dk,4.914e16_dk,1.519e16_dk,3.896e14_dk,3.040e13_dk,0._dk,&
    &130.0_dk,1.326e17_dk,4.625e16_dk,1.375e16_dk,3.458e14_dk,2.972e13_dk,0._dk,&
                                                               
    &131.0_dk,1.215e17_dk,4.361e16_dk,1.247e16_dk,3.078e14_dk,2.907e13_dk,0._dk,& 
    &132.0_dk,1.116e17_dk,4.118e16_dk,1.134e16_dk,2.748e14_dk,2.846e13_dk,0._dk,&
    &133.0_dk,1.026e17_dk,3.894e16_dk,1.034e16_dk,2.460e14_dk,2.787e13_dk,0._dk,&
    &134.0_dk,9.460e16_dk,3.688e16_dk,9.444e15_dk,2.207e14_dk,2.732e13_dk,0._dk,&
    &135.0_dk,8.735e16_dk,3.497e16_dk,8.645e15_dk,1.985e14_dk,2.679e13_dk,0._dk,&
    &136.0_dk,8.080e16_dk,3.320e16_dk,7.927e15_dk,1.789e14_dk,2.629e13_dk,0._dk,&
    &137.0_dk,7.487e16_dk,3.156e16_dk,7.283e15_dk,1.616e14_dk,2.581e13_dk,0._dk,&
    &138.0_dk,6.947e16_dk,3.004e16_dk,6.702e15_dk,1.463e14_dk,2.535e13_dk,0._dk,&
    &139.0_dk,6.456e16_dk,2.862e16_dk,6.177e15_dk,1.326e14_dk,2.491e13_dk,0._dk,&
    &140.0_dk,6.009e16_dk,2.729e16_dk,5.702e15_dk,1.205e14_dk,2.449e13_dk,0._dk,&
                                                               
    &141.0_dk,5.600e16_dk,2.605e16_dk,5.272e15_dk,1.096e14_dk,2.408e13_dk,0._dk,&
    &142.0_dk,5.225e16_dk,2.489e16_dk,4.881e15_dk,9.989e13_dk,2.369e13_dk,0._dk,&
    &143.0_dk,4.881e16_dk,2.380e16_dk,4.524e15_dk,9.118e13_dk,2.332e13_dk,0._dk,&
    &144.0_dk,4.565e16_dk,2.278e16_dk,4.199e15_dk,8.335e13_dk,2.296e13_dk,0._dk,&
    &145.0_dk,4.275e16_dk,2.183e16_dk,3.903e15_dk,7.630e13_dk,2.261e13_dk,0._dk,&
    &146.0_dk,4.007e16_dk,2.092e16_dk,3.631e15_dk,6.994e13_dk,2.228e13_dk,0._dk,&
    &147.0_dk,3.760e16_dk,2.007e16_dk,3.382e15_dk,6.420e13_dk,2.196e13_dk,0._dk,&
    &148.0_dk,3.531e16_dk,1.927e16_dk,3.153e15_dk,5.900e13_dk,2.165e13_dk,0._dk,&
    &149.0_dk,3.320e16_dk,1.852e16_dk,2.943e15_dk,5.428e13_dk,2.135e13_dk,0._dk,&
    &150._dk,3.124e16_dk,1.780e16_dk,2.750e15_dk,5.000e13_dk,2.106e13_dk,3.767e11_dk,&
                                                                    
    &151._dk,2.942e16_dk,1.712e16_dk,2.572e15_dk,4.611e13_dk,2.078e13_dk,3.659e11_dk,&
    &152._dk,2.773e16_dk,1.648e16_dk,2.407e15_dk,4.256e13_dk,2.051e13_dk,3.557e11_dk,&
    &153._dk,2.616e16_dk,1.587e16_dk,2.255e15_dk,3.933e13_dk,2.024e13_dk,3.461e11_dk,&
    &154._dk,2.469e16_dk,1.530e16_dk,2.114e15_dk,3.638e13_dk,1.999e13_dk,3.369e11_dk,&
    &155._dk,2.333e16_dk,1.475e16_dk,1.984e15_dk,3.368e13_dk,1.974e13_dk,3.283e11_dk,&
    &156._dk,2.206e16_dk,1.423e16_dk,1.863e15_dk,3.121e13_dk,1.950e13_dk,3.201e11_dk,&
    &157._dk,2.087e16_dk,1.373e16_dk,1.751e15_dk,2.895e13_dk,1.927e13_dk,3.123e11_dk,&
    &158._dk,1.975e16_dk,1.326e16_dk,1.647e15_dk,2.687e13_dk,1.905e13_dk,3.049e11_dk,&
    &159._dk,1.871e16_dk,1.281e16_dk,1.550e15_dk,2.496e13_dk,1.883e13_dk,2.978e11_dk,&
    &160._dk,1.774e16_dk,1.238e16_dk,1.460e15_dk,2.321e13_dk,1.861e13_dk,2.911e11_dk,&
                                                                    
    &161._dk,1.682e16_dk,1.197e16_dk,1.376e15_dk,2.159e13_dk,1.841e13_dk,2.847e11_dk,& 
    &162._dk,1.596e16_dk,1.158e16_dk,1.297e15_dk,2.011e13_dk,1.820e13_dk,2.786e11_dk,&
    &163._dk,1.516e16_dk,1.120e16_dk,1.224e15_dk,1.874e13_dk,1.801e13_dk,2.728e11_dk,&
    &164._dk,1.440e16_dk,1.085e16_dk,1.156e15_dk,1.747e13_dk,1.782e13_dk,2.672e11_dk,&
    &165._dk,1.369e16_dk,1.050e16_dk,1.092e15_dk,1.630e13_dk,1.763e13_dk,2.619e11_dk,&
    &166._dk,1.302e16_dk,1.018e16_dk,1.032e15_dk,1.522e13_dk,1.745e13_dk,2.568e11_dk,&
    &167._dk,1.239e16_dk,9.863e15_dk,9.757e14_dk,1.422e13_dk,1.727e13_dk,2.520e11_dk,&
    &168._dk,1.179e16_dk,9.562e15_dk,9.232e14_dk,1.329e13_dk,1.710e13_dk,2.473e11_dk,&
    &169._dk,1.123e16_dk,9.273e15_dk,8.739e14_dk,1.243e13_dk,1.693e13_dk,2.429e11_dk,&
    &170._dk,1.070e16_dk,8.996e15_dk,8.277e14_dk,1.163e13_dk,1.676e13_dk,2.386e11_dk,&
                                                                    
    &171._dk,1.020e16_dk,8.730e15_dk,7.843e14_dk,1.089e13_dk,1.660e13_dk,2.345e11_dk,&
    &172._dk,9.724e15_dk,8.474e15_dk,7.435e14_dk,1.020e13_dk,1.644e13_dk,2.306e11_dk,&
    &173._dk,9.277e15_dk,8.228e15_dk,7.051e14_dk,9.565e12_dk,1.629e13_dk,2.268e11_dk,&
    &174._dk,8.853e15_dk,7.992e15_dk,6.690e14_dk,8.970e12_dk,1.614e13_dk,2.232e11_dk,&
    &175._dk,8.452e15_dk,7.765e15_dk,6.350e14_dk,8.417e12_dk,1.599e13_dk,2.197e11_dk,&
    &176._dk,8.072e15_dk,7.546e15_dk,6.030e14_dk,7.901e12_dk,1.585e13_dk,2.163e11_dk,&
    &177._dk,7.712e15_dk,7.335e15_dk,5.728e14_dk,7.420e12_dk,1.571e13_dk,2.131e11_dk,&
    &178._dk,7.371e15_dk,7.132e15_dk,5.443e14_dk,6.971e12_dk,1.557e13_dk,2.100e11_dk,&
    &179._dk,7.047e15_dk,6.936e15_dk,5.174e14_dk,6.553e12_dk,1.543e13_dk,2.070e11_dk,&
    &180._dk,6.740e15_dk,6.747e15_dk,4.921e14_dk,6.162e12_dk,1.530e13_dk,2.041e11_dk,&
                                                                    
    &181._dk,6.448e15_dk,6.565e15_dk,4.681e14_dk,5.797e12_dk,1.517e13_dk,2.013e11_dk,&
    &182._dk,6.170e15_dk,6.389e15_dk,4.455e14_dk,5.456e12_dk,1.504e13_dk,1.987e11_dk,&
    &183._dk,5.907e15_dk,6.220e15_dk,4.241e14_dk,5.136e12_dk,1.492e13_dk,1.961e11_dk,&
    &184._dk,5.656e15_dk,6.056e15_dk,4.039e14_dk,4.838e12_dk,1.479e13_dk,1.936e11_dk,&
    &185._dk,5.417e15_dk,5.897e15_dk,3.847e14_dk,4.558e12_dk,1.467e13_dk,1.911e11_dk,&
    &186._dk,5.190e15_dk,5.744e15_dk,3.666e14_dk,4.296e12_dk,1.456e13_dk,1.888e11_dk,&
    &187._dk,4.974e15_dk,5.596e15_dk,3.494e14_dk,4.050e12_dk,1.444e13_dk,1.866e11_dk,&
    &188._dk,4.768e15_dk,5.453e15_dk,3.331e14_dk,3.820e12_dk,1.433e13_dk,1.844e11_dk,&
    &189._dk,4.572e15_dk,5.315e15_dk,3.177e14_dk,3.604e12_dk,1.421e13_dk,1.823e11_dk,&
    &190._dk,4.385e15_dk,5.181e15_dk,3.031e14_dk,3.401e12_dk,1.410e13_dk,1.802e11_dk,&
                                                                    
    &191._dk,4.207e15_dk,5.051e15_dk,2.892e14_dk,3.211e12_dk,1.400e13_dk,1.782e11_dk,& 
    &192._dk,4.037e15_dk,4.926e15_dk,2.760e14_dk,3.033e12_dk,1.389e13_dk,1.763e11_dk,&
    &193._dk,3.875e15_dk,4.804e15_dk,2.635e14_dk,2.865e12_dk,1.379e13_dk,1.745e11_dk,&
    &194._dk,3.720e15_dk,4.686e15_dk,2.517e14_dk,2.707e12_dk,1.368e13_dk,1.727e11_dk,&
    &195._dk,3.572e15_dk,4.572e15_dk,2.404e14_dk,2.558e12_dk,1.358e13_dk,1.709e11_dk,&
    &196._dk,3.430e15_dk,4.461e15_dk,2.297e14_dk,2.419e12_dk,1.348e13_dk,1.692e11_dk,&
    &197._dk,3.295e15_dk,4.354e15_dk,2.195e14_dk,2.288e12_dk,1.339e13_dk,1.676e11_dk,&
    &198._dk,3.166e15_dk,4.249e15_dk,2.098e14_dk,2.164e12_dk,1.329e13_dk,1.660e11_dk,&
    &199._dk,3.043e15_dk,4.148e15_dk,2.006e14_dk,2.047e12_dk,1.319e13_dk,1.645e11_dk,&
    &200._dk,2.925e15_dk,4.050e15_dk,1.918e14_dk,1.938e12_dk,1.310e13_dk,1.630e11_dk,&
                                                                    
    &201._dk,2.812e15_dk,3.955e15_dk,1.834e14_dk,1.834e12_dk,1.301e13_dk,1.615e11_dk,&
    &202._dk,2.704e15_dk,3.862e15_dk,1.755e14_dk,1.737e12_dk,1.292e13_dk,1.601e11_dk,&
    &203._dk,2.601e15_dk,3.773e15_dk,1.679e14_dk,1.645e12_dk,1.283e13_dk,1.587e11_dk,&
    &204._dk,2.502e15_dk,3.685e15_dk,1.607e14_dk,1.558e12_dk,1.274e13_dk,1.574e11_dk,&
    &205._dk,2.407e15_dk,3.600e15_dk,1.538e14_dk,1.477e12_dk,1.266e13_dk,1.561e11_dk,&
    &206._dk,2.316e15_dk,3.518e15_dk,1.473e14_dk,1.399e12_dk,1.257e13_dk,1.548e11_dk,&
    &207._dk,2.229e15_dk,3.438e15_dk,1.410e14_dk,1.327e12_dk,1.249e13_dk,1.536e11_dk,&
    &208._dk,2.146e15_dk,3.360e15_dk,1.351e14_dk,1.258e12_dk,1.240e13_dk,1.524e11_dk,&
    &209._dk,2.066e15_dk,3.284e15_dk,1.294e14_dk,1.193e12_dk,1.232e13_dk,1.512e11_dk,&
    &210._dk,1.989e15_dk,3.211e15_dk,1.239e14_dk,1.131e12_dk,1.224e13_dk,1.501e11_dk,&
                                                                    
    &211._dk,1.915e15_dk,3.139e15_dk,1.188e14_dk,1.073e12_dk,1.216e13_dk,1.490e11_dk,&
    &212._dk,1.845e15_dk,3.069e15_dk,1.138e14_dk,1.019e12_dk,1.208e13_dk,1.479e11_dk,&
    &213._dk,1.777e15_dk,3.001e15_dk,1.091e14_dk,9.666e11_dk, 1.201e13_dk,1.468e11_dk,&
    &214._dk,1.712e15_dk,2.935e15_dk,1.046e14_dk,9.176e11_dk, 1.193e13_dk,1.458e11_dk,&
    &215._dk,1.650e15_dk,2.871e15_dk,1.003e14_dk,8.711e11_dk, 1.185e13_dk,1.448e11_dk,&
    &216._dk,1.590e15_dk,2.808e15_dk,9.617e13_dk,8.272e11_dk, 1.178e13_dk,1.439e11_dk,&
    &217._dk,1.533e15_dk,2.747e15_dk,9.224e13_dk,7.856e11_dk, 1.171e13_dk,1.429e11_dk,&
    &218._dk,1.477e15_dk,2.688e15_dk,8.848e13_dk,7.463e11_dk, 1.163e13_dk,1.420e11_dk,&
    &219._dk,1.424e15_dk,2.630e15_dk,8.489e13_dk,7.090e11_dk, 1.156e13_dk,1.411e11_dk,&
    &220._dk,1.373e15_dk,2.573e15_dk,8.145e13_dk,6.737e11_dk, 1.149e13_dk,1.402e11_dk,&
                                                                     
    &221._dk,1.324e15_dk,2.518e15_dk,7.816e13_dk,6.402e11_dk, 1.142e13_dk,1.393e11_dk,& 
    &222._dk,1.277e15_dk,2.465e15_dk,7.502e13_dk,6.085e11_dk, 1.135e13_dk,1.385e11_dk,&
    &223._dk,1.232e15_dk,2.412e15_dk,7.201e13_dk,5.785e11_dk, 1.128e13_dk,1.377e11_dk,&
    &224._dk,1.188e15_dk,2.361e15_dk,6.913e13_dk,5.500e11_dk, 1.122e13_dk,1.369e11_dk,&
    &225._dk,1.147e15_dk,2.312e15_dk,6.637e13_dk,5.230e11_dk, 1.115e13_dk,1.361e11_dk,&
    &226._dk,1.106e15_dk,2.263e15_dk,6.373e13_dk,4.974e11_dk, 1.108e13_dk,1.353e11_dk,&
    &227._dk,1.068e15_dk,2.216e15_dk,6.121e13_dk,4.731e11_dk, 1.102e13_dk,1.345e11_dk,&
    &228._dk,1.030e15_dk,2.170e15_dk,5.879e13_dk,4.501e11_dk, 1.095e13_dk,1.338e11_dk,&
    &229._dk,9.945e14_dk,2.125e15_dk,5.647e13_dk,4.282e11_dk, 1.089e13_dk,1.331e11_dk,&
    &230._dk,9.600e14_dk,2.081e15_dk,5.425e13_dk,4.075e11_dk, 1.083e13_dk,1.324e11_dk,&
                                                                     
    &231._dk,9.268e14_dk,2.038e15_dk,5.212e13_dk,3.878e11_dk, 1.076e13_dk,1.317e11_dk,&
    &232._dk,8.948e14_dk,1.996e15_dk,5.009e13_dk,3.691e11_dk, 1.070e13_dk,1.310e11_dk,&
    &233._dk,8.640e14_dk,1.955e15_dk,4.813e13_dk,3.514e11_dk, 1.064e13_dk,1.304e11_dk,&
    &234._dk,8.343e14_dk,1.915e15_dk,4.626e13_dk,3.345e11_dk, 1.058e13_dk,1.297e11_dk,&
    &235._dk,8.058e14_dk,1.876e15_dk,4.446e13_dk,3.185e11_dk, 1.052e13_dk,1.291e11_dk,&
    &236._dk,7.782e14_dk,1.838e15_dk,4.274e13_dk,3.033e11_dk, 1.046e13_dk,1.285e11_dk,&
    &237._dk,7.517e14_dk,1.801e15_dk,4.109e13_dk,2.888e11_dk, 1.040e13_dk,1.279e11_dk,&
    &238._dk,7.262e14_dk,1.765e15_dk,3.951e13_dk,2.751e11_dk, 1.034e13_dk,1.273e11_dk,&
    &239._dk,7.016e14_dk,1.729e15_dk,3.799e13_dk,2.621e11_dk, 1.029e13_dk,1.267e11_dk,&
    &240._dk,6.778e14_dk,1.695e15_dk,3.653e13_dk,2.497e11_dk, 1.023e13_dk,1.261e11_dk,&
                                                                     
    &241._dk,6.550e14_dk,1.661e15_dk,3.513e13_dk,2.379e11_dk, 1.017e13_dk,1.256e11_dk,&
    &242._dk,6.329e14_dk,1.628e15_dk,3.379e13_dk,2.267e11_dk, 1.012e13_dk,1.250e11_dk,&
    &243._dk,6.117e14_dk,1.595e15_dk,3.251e13_dk,2.160e11_dk, 1.006e13_dk,1.245e11_dk,&
    &244._dk,5.912e14_dk,1.564e15_dk,3.127e13_dk,2.059e11_dk, 1.001e13_dk,1.240e11_dk,&
    &245._dk,5.714e14_dk,1.533e15_dk,3.008e13_dk,1.962e11_dk, 9.953e12_dk,1.234e11_dk,&
    &246._dk,5.523e14_dk,1.503e15_dk,2.895e13_dk,1.871e11_dk, 9.899e12_dk,1.229e11_dk,&
    &247._dk,5.339e14_dk,1.473e15_dk,2.785e13_dk,1.783e11_dk, 9.846e12_dk,1.224e11_dk,&
    &248._dk,5.162e14_dk,1.444e15_dk,2.680e13_dk,1.700e11_dk, 9.794e12_dk,1.219e11_dk,&
    &249._dk,4.991e14_dk,1.416e15_dk,2.579e13_dk,1.621e11_dk, 9.741e12_dk,1.215e11_dk,&
    &250._dk,4.826e14_dk,1.388e15_dk,2.482e13_dk,1.546e11_dk, 9.690e12_dk,1.210e11_dk,&
                                                                     
    &251._dk,4.666e14_dk,1.361e15_dk,2.389e13_dk,1.474e11_dk, 9.638e12_dk,1.205e11_dk,& 
    &252._dk,4.512e14_dk,1.335e15_dk,2.300e13_dk,1.406e11_dk, 9.587e12_dk,1.201e11_dk,&
    &253._dk,4.364e14_dk,1.309e15_dk,2.214e13_dk,1.341e11_dk, 9.537e12_dk,1.196e11_dk,&
    &254._dk,4.221e14_dk,1.284e15_dk,2.132e13_dk,1.280e11_dk, 9.487e12_dk,1.192e11_dk,&
    &255._dk,4.082e14_dk,1.259e15_dk,2.052e13_dk,1.221e11_dk, 9.438e12_dk,1.188e11_dk,&
    &256._dk,3.949e14_dk,1.235e15_dk,1.976e13_dk,1.165e11_dk, 9.389e12_dk,1.183e11_dk,&
    &257._dk,3.820e14_dk,1.211e15_dk,1.903e13_dk,1.111e11_dk, 9.340e12_dk,1.179e11_dk,&
    &258._dk,3.695e14_dk,1.188e15_dk,1.832e13_dk,1.060e11_dk, 9.292e12_dk,1.175e11_dk,&
    &259._dk,3.575e14_dk,1.165e15_dk,1.765e13_dk,1.012e11_dk, 9.244e12_dk,1.171e11_dk,&
    &260._dk,3.459e14_dk,1.143e15_dk,1.700e13_dk,9.658e10_dk,9.196e12_dk,1.167e11_dk,&
                                                                     
    &261._dk,3.347e14_dk,1.121e15_dk,1.637e13_dk,9.218e10_dk,9.149e12_dk,1.163e11_dk,& 
    &262._dk,3.238e14_dk,1.100e15_dk,1.577e13_dk,8.799e10_dk,9.103e12_dk,1.159e11_dk,& 
    &263._dk,3.134e14_dk,1.079e15_dk,1.519e13_dk,8.399e10_dk,9.056e12_dk,1.156e11_dk,& 
    &264._dk,3.033e14_dk,1.059e15_dk,1.463e13_dk,8.019e10_dk,9.010e12_dk,1.152e11_dk,& 
    &265._dk,2.935e14_dk,1.039e15_dk,1.410e13_dk,7.655e10_dk,8.965e12_dk,1.148e11_dk,& 
    &266._dk,2.841e14_dk,1.019e15_dk,1.358e13_dk,7.309e10_dk,8.920e12_dk,1.145e11_dk,& 
    &267._dk,2.749e14_dk,9.998e14_dk,1.309e13_dk,6.979e10_dk,8.875e12_dk,1.141e11_dk,& 
    &268._dk,2.661e14_dk,9.811e14_dk,1.261e13_dk,6.665e10_dk,8.830e12_dk,1.138e11_dk,& 
    &269._dk,2.576e14_dk,9.627e14_dk,1.215e13_dk,6.365e10_dk,8.786e12_dk,1.134e11_dk,& 
    &270._dk,2.494e14_dk,9.447e14_dk,1.171e13_dk,6.078e10_dk,8.743e12_dk,1.131e11_dk,& 
                                                                     
    &271._dk,2.414e14_dk,9.270e14_dk,1.128e13_dk,5.805e10_dk,8.699e12_dk,1.127e11_dk,& 
    &272._dk,2.337e14_dk,9.097e14_dk,1.088e13_dk,5.545e10_dk,8.656e12_dk,1.124e11_dk,& 
    &273._dk,2.263e14_dk,8.928e14_dk,1.048e13_dk,5.297e10_dk,8.613e12_dk,1.121e11_dk,& 
    &274._dk,2.191e14_dk,8.762e14_dk,1.010e13_dk,5.060e10_dk,8.571e12_dk,1.118e11_dk,& 
    &275._dk,2.121e14_dk,8.599e14_dk,9.739e12_dk,4.834e10_dk,8.529e12_dk,1.115e11_dk,& 
    &276._dk,2.054e14_dk,8.440e14_dk,9.388e12_dk,4.618e10_dk,8.487e12_dk,1.112e11_dk,& 
    &277._dk,1.989e14_dk,8.284e14_dk,9.050e12_dk,4.412e10_dk,8.445e12_dk,1.109e11_dk,& 
    &278._dk,1.926e14_dk,8.131e14_dk,8.725e12_dk,4.216e10_dk,8.404e12_dk,1.106e11_dk,& 
    &279._dk,1.865e14_dk,7.981e14_dk,8.412e12_dk,4.029e10_dk,8.363e12_dk,1.103e11_dk,& 
    &280._dk,1.806e14_dk,7.834e14_dk,8.110e12_dk,3.850e10_dk,8.322e12_dk,1.100e11_dk,& 
                                                                     
    &281._dk,1.750e14_dk,7.691e14_dk,7.820e12_dk,3.679e10_dk,8.282e12_dk,1.097e11_dk,&  
    &282._dk,1.695e14_dk,7.549e14_dk,7.540e12_dk,3.516e10_dk,8.242e12_dk,1.094e11_dk,& 
    &283._dk,1.641e14_dk,7.411e14_dk,7.271e12_dk,3.360e10_dk,8.202e12_dk,1.091e11_dk,& 
    &284._dk,1.590e14_dk,7.276e14_dk,7.011e12_dk,3.212e10_dk,8.163e12_dk,1.088e11_dk,& 
    &285._dk,1.540e14_dk,7.143e14_dk,6.761e12_dk,3.070e10_dk,8.124e12_dk,1.086e11_dk,& 
    &286._dk,1.492e14_dk,7.012e14_dk,6.521e12_dk,2.935e10_dk,8.085e12_dk,1.083e11_dk,& 
    &287._dk,1.445e14_dk,6.885e14_dk,6.289e12_dk,2.805e10_dk,8.046e12_dk,1.080e11_dk,& 
    &288._dk,1.400e14_dk,6.759e14_dk,6.065e12_dk,2.682e10_dk,8.008e12_dk,1.078e11_dk,& 
    &289._dk,1.356e14_dk,6.637e14_dk,5.850e12_dk,2.564e10_dk,7.969e12_dk,1.075e11_dk,& 
    &290._dk,1.314e14_dk,6.516e14_dk,5.643e12_dk,2.451e10_dk,7.931e12_dk,1.073e11_dk,& 
                                                                     
    &291._dk,1.273e14_dk,6.398e14_dk,5.443e12_dk,2.344e10_dk,7.894e12_dk,1.070e11_dk,& 
    &292._dk,1.234e14_dk,6.282e14_dk,5.251e12_dk,2.241e10_dk,7.856e12_dk,1.067e11_dk,& 
    &293._dk,1.195e14_dk,6.169e14_dk,5.065e12_dk,2.143e10_dk,7.819e12_dk,1.065e11_dk,& 
    &294._dk,1.158e14_dk,6.058e14_dk,4.886e12_dk,2.049e10_dk,7.782e12_dk,1.063e11_dk,& 
    &295._dk,1.122e14_dk,5.948e14_dk,4.714e12_dk,1.960e10_dk,7.746e12_dk,1.060e11_dk,& 
    &296._dk,1.088e14_dk,5.841e14_dk,4.548e12_dk,1.874e10_dk,7.709e12_dk,1.058e11_dk,& 
    &297._dk,1.054e14_dk,5.736e14_dk,4.388e12_dk,1.792e10_dk,7.673e12_dk,1.055e11_dk,& 
    &298._dk,1.021e14_dk,5.633e14_dk,4.234e12_dk,1.714e10_dk,7.637e12_dk,1.053e11_dk,& 
    &299._dk,9.898e13_dk,5.532e14_dk,4.085e12_dk,1.639e10_dk,7.602e12_dk,1.051e11_dk,& 
    &300._dk,9.593e13_dk,5.433e14_dk,3.942e12_dk,1.568e10_dk,7.566e12_dk,1.049e11_dk,& 
                                                                     
    &302._dk,9.011e13_dk,5.241e14_dk,3.670e12_dk,1.435e10_dk,7.496e12_dk,1.044e11_dk,& 
    &304._dk,8.466e13_dk,5.055e14_dk,3.418e12_dk,1.313e10_dk,7.427e12_dk,1.040e11_dk,& 
    &306._dk,7.954e13_dk,4.877e14_dk,3.184e12_dk,1.202e10_dk,7.358e12_dk,1.035e11_dk,& 
    &308._dk,7.474e13_dk,4.705e14_dk,2.966e12_dk,1.100e10_dk,7.290e12_dk,1.031e11_dk,& 
    &310._dk,7.024e13_dk,4.540e14_dk,2.763e12_dk,1.007e10_dk,7.224e12_dk,1.027e11_dk,& 
    &312._dk,6.602e13_dk,4.380e14_dk,2.574e12_dk,9.223e09_dk,7.157e12_dk,1.023e11_dk,& 
    &314._dk,6.206e13_dk,4.227e14_dk,2.399e12_dk,8.447e09_dk,7.092e12_dk,1.019e11_dk,& 
    &316._dk,5.834e13_dk,4.079e14_dk,2.236e12_dk,7.737e09_dk,7.028e12_dk,1.015e11_dk,& 
    &318._dk,5.485e13_dk,3.937e14_dk,2.084e12_dk,7.087e09_dk,6.964e12_dk,1.012e11_dk,& 
    &320._dk,5.158e13_dk,3.800e14_dk,1.942e12_dk,6.493e09_dk,6.901e12_dk,1.008e11_dk,& 
    &322._dk,4.850e13_dk,3.668e14_dk,1.811e12_dk,5.950e09_dk,6.839e12_dk,1.004e11_dk,&  
                                                                     
    &324._dk,4.561e13_dk,3.541e14_dk,1.688e12_dk,5.452e09_dk,6.777e12_dk,1.001e11_dk,& 
    &326._dk,4.290e13_dk,3.418e14_dk,1.574e12_dk,4.997e09_dk,6.717e12_dk,9.971e10_dk,& 
    &328._dk,4.035e13_dk,3.300e14_dk,1.468e12_dk,4.580e09_dk,6.657e12_dk,9.937e10_dk,& 
    &330._dk,3.796e13_dk,3.186e14_dk,1.369e12_dk,4.199e09_dk,6.597e12_dk,9.903e10_dk,& 
    &332._dk,3.571e13_dk,3.076e14_dk,1.277e12_dk,3.850e09_dk,6.538e12_dk,9.869e10_dk,& 
    &334._dk,3.360e13_dk,2.970e14_dk,1.191e12_dk,3.530e09_dk,6.480e12_dk,9.836e10_dk,& 
    &336._dk,3.162e13_dk,2.868e14_dk,1.111e12_dk,3.237e09_dk,6.423e12_dk,9.804e10_dk,& 
    &338._dk,2.975e13_dk,2.770e14_dk,1.037e12_dk,2.969e09_dk,6.366e12_dk,9.772e10_dk,& 
    &340._dk,2.800e13_dk,2.675e14_dk,9.674e11_dk, 2.723e09_dk,6.310e12_dk,9.741e10_dk,&
    &342._dk,2.635e13_dk,2.583e14_dk,9.027e11_dk, 2.498e09_dk,6.254e12_dk,9.710e10_dk,&
                                                                     
    &344._dk,2.480e13_dk,2.495e14_dk,8.424e11_dk, 2.292e09_dk,6.199e12_dk,9.680e10_dk,&
    &346._dk,2.335e13_dk,2.410e14_dk,7.862e11_dk, 2.103e09_dk,6.145e12_dk,9.650e10_dk,&
    &348._dk,2.198e13_dk,2.328e14_dk,7.338e11_dk, 1.929e09_dk,6.091e12_dk,9.620e10_dk,&
    &350._dk,2.069e13_dk,2.249e14_dk,6.850e11_dk, 1.771e09_dk,6.038e12_dk,9.591e10_dk,&
    &352._dk,1.948e13_dk,2.172e14_dk,6.394e11_dk, 1.625e09_dk,5.985e12_dk,9.562e10_dk,&
    &354._dk,1.834e13_dk,2.099e14_dk,5.969e11_dk, 1.491e09_dk,5.933e12_dk,9.534e10_dk,&
    &356._dk,1.727e13_dk,2.027e14_dk,5.573e11_dk, 1.369e09_dk,5.881e12_dk,9.505e10_dk,&
    &358._dk,1.627e13_dk,1.959e14_dk,5.204e11_dk, 1.257e09_dk,5.830e12_dk,9.478e10_dk,&
    &360._dk,1.532e13_dk,1.893e14_dk,4.859e11_dk, 1.154e09_dk,5.779e12_dk,9.450e10_dk,&
    &362._dk,1.443e13_dk,1.829e14_dk,4.538e11_dk, 1.059e09_dk,5.729e12_dk,9.423e10_dk,&
                                                                     
    &364._dk,1.359e13_dk,1.767e14_dk,4.238e11_dk, 9.728e08_dk,5.680e12_dk,9.397e10_dk,&
    &366._dk,1.280e13_dk,1.707e14_dk,3.958e11_dk, 8.934e08_dk,5.631e12_dk,9.370e10_dk,&
    &368._dk,1.206e13_dk,1.650e14_dk,3.697e11_dk, 8.205e08_dk,5.582e12_dk,9.344e10_dk,&
    &370._dk,1.136e13_dk,1.594e14_dk,3.454e11_dk, 7.536e08_dk,5.534e12_dk,9.318e10_dk,&
    &372._dk,1.070e13_dk,1.541e14_dk,3.226e11_dk, 6.922e08_dk,5.487e12_dk,9.293e10_dk,&
    &374._dk,1.008e13_dk,1.489e14_dk,3.014e11_dk, 6.359e08_dk,5.439e12_dk,9.268e10_dk,&
    &376._dk,9.498e12_dk,1.439e14_dk,2.816e11_dk, 5.842e08_dk,5.393e12_dk,9.243e10_dk,&
    &378._dk,8.950e12_dk,1.391e14_dk,2.631e11_dk, 5.367e08_dk,5.347e12_dk,9.218e10_dk,&
    &380._dk,8.434e12_dk,1.344e14_dk,2.459e11_dk, 4.932e08_dk,5.301e12_dk,9.193e10_dk,&
    &382._dk,7.948e12_dk,1.300e14_dk,2.297e11_dk, 4.532e08_dk,5.256e12_dk,9.169e10_dk,& 
                                                                     
    &384._dk,7.490e12_dk,1.256e14_dk,2.147e11_dk, 4.165e08_dk,5.211e12_dk,9.145e10_dk,&
    &386._dk,7.059e12_dk,1.214e14_dk,2.006e11_dk, 3.827e08_dk,5.167e12_dk,9.121e10_dk,&
    &388._dk,6.653e12_dk,1.174e14_dk,1.875e11_dk, 3.518e08_dk,5.123e12_dk,9.098e10_dk,&
    &390._dk,6.271e12_dk,1.135e14_dk,1.753e11_dk, 3.234e08_dk,5.079e12_dk,9.074e10_dk,&
    &392._dk,5.911e12_dk,1.097e14_dk,1.638e11_dk, 2.972e08_dk,5.036e12_dk,9.051e10_dk,&
    &394._dk,5.572e12_dk,1.061e14_dk,1.532e11_dk, 2.733e08_dk,4.993e12_dk,9.028e10_dk,&
    &396._dk,5.253e12_dk,1.025e14_dk,1.432e11_dk, 2.512e08_dk,4.951e12_dk,9.005e10_dk,&
    &398._dk,4.952e12_dk,9.913e13_dk,1.339e11_dk, 2.310e08_dk,4.909e12_dk,8.983e10_dk,&
    &400._dk,4.669e12_dk,9.584e13_dk,1.252e11_dk, 2.124e08_dk,4.868e12_dk,8.960e10_dk,&
    &402._dk,4.402e12_dk,9.267e13_dk,1.170e11_dk, 1.953e08_dk,4.827e12_dk,8.938e10_dk,&
                                                                     
    &404._dk,4.151e12_dk,8.960e13_dk,1.094e11_dk, 1.796e08_dk,4.786e12_dk,8.916e10_dk,&
    &406._dk,3.914e12_dk,8.664e13_dk,1.023e11_dk, 1.652e08_dk,4.746e12_dk,8.894e10_dk,&
    &408._dk,3.691e12_dk,8.378e13_dk,9.568e10_dk, 1.519e08_dk,4.706e12_dk,8.872e10_dk,&
    &410._dk,3.480e12_dk,8.101e13_dk,8.948e10_dk, 1.397e08_dk,4.666e12_dk,8.851e10_dk,&
    &412._dk,3.282e12_dk,7.834e13_dk,8.369e10_dk, 1.285e08_dk,4.627e12_dk,8.829e10_dk,&
    &414._dk,3.095e12_dk,7.576e13_dk,7.827e10_dk, 1.182e08_dk,4.588e12_dk,8.808e10_dk,&
    &416._dk,2.919e12_dk,7.327e13_dk,7.321e10_dk, 1.088e08_dk,4.550e12_dk,8.787e10_dk,&
    &418._dk,2.754e12_dk,7.086e13_dk,6.848e10_dk, 1.001e08_dk,4.512e12_dk,8.766e10_dk,&
    &420._dk,2.597e12_dk,6.853e13_dk,6.406e10_dk, 9.207e07_dk,4.474e12_dk,8.745e10_dk,&
    &422._dk,2.450e12_dk,6.628e13_dk,5.993e10_dk, 8.472e07_dk,4.437e12_dk,8.725e10_dk,&
                                                                     
    &424._dk,2.311e12_dk,6.410e13_dk,5.606e10_dk, 7.796e07_dk,4.399e12_dk,8.704e10_dk,&
    &426._dk,2.180e12_dk,6.200e13_dk,5.245e10_dk, 7.174e07_dk,4.363e12_dk,8.684e10_dk,&
    &428._dk,2.057e12_dk,5.997e13_dk,4.907e10_dk, 6.602e07_dk,4.326e12_dk,8.663e10_dk,&
    &430._dk,1.940e12_dk,5.800e13_dk,4.592e10_dk, 6.076e07_dk,4.290e12_dk,8.643e10_dk,&
    &432._dk,1.831e12_dk,5.611e13_dk,4.297e10_dk, 5.593e07_dk,4.255e12_dk,8.623e10_dk,&
    &434._dk,1.727e12_dk,5.427e13_dk,4.020e10_dk, 5.148e07_dk,4.219e12_dk,8.603e10_dk,&
    &436._dk,1.630e12_dk,5.250e13_dk,3.762e10_dk, 4.739e07_dk,4.184e12_dk,8.583e10_dk,&
    &438._dk,1.538e12_dk,5.079e13_dk,3.521e10_dk, 4.362e07_dk,4.150e12_dk,8.564e10_dk,&
    &440._dk,1.451e12_dk,4.913e13_dk,3.295e10_dk, 4.016e07_dk,4.115e12_dk,8.544e10_dk,& 
    &442._dk,1.369e12_dk,4.753e13_dk,3.084e10_dk, 3.698e07_dk,4.081e12_dk,8.525e10_dk,&  
                                                                      
    &444._dk,1.292e12_dk,4.598e13_dk,2.887e10_dk, 3.404e07_dk,4.047e12_dk,8.505e10_dk,& 
    &446._dk,1.220e12_dk,4.448e13_dk,2.702e10_dk, 3.135e07_dk,4.014e12_dk,8.486e10_dk,& 
    &448._dk,1.151e12_dk,4.303e13_dk,2.529e10_dk, 2.887e07_dk,3.981e12_dk,8.467e10_dk,& 
    &450._dk,1.086e12_dk,4.164e13_dk,2.368e10_dk, 2.658e07_dk,3.948e12_dk,8.448e10_dk,& 
    &452._dk,1.025e12_dk,4.028e13_dk,2.216e10_dk, 2.448e07_dk,3.915e12_dk,8.429e10_dk,& 
    &454._dk,9.679e11_dk, 3.898e13_dk,2.075e10_dk, 2.255e07_dk,3.883e12_dk,8.410e10_dk,&
    &456._dk,9.136e11_dk, 3.771e13_dk,1.943e10_dk, 2.077e07_dk,3.851e12_dk,8.391e10_dk,&
    &458._dk,8.625e11_dk, 3.649e13_dk,1.819e10_dk, 1.913e07_dk,3.819e12_dk,8.373e10_dk,&
    &460._dk,8.142e11_dk, 3.531e13_dk,1.703e10_dk, 1.762e07_dk,3.788e12_dk,8.354e10_dk,&
    &462._dk,7.686e11_dk, 3.416e13_dk,1.595e10_dk, 1.623e07_dk,3.757e12_dk,8.336e10_dk,&
                                                                      
    &464._dk,7.256e11_dk, 3.306e13_dk,1.493e10_dk, 1.495e07_dk,3.726e12_dk,8.317e10_dk,&
    &466._dk,6.851e11_dk, 3.199e13_dk,1.398e10_dk, 1.377e07_dk,3.695e12_dk,8.299e10_dk,&
    &468._dk,6.468e11_dk, 3.096e13_dk,1.309e10_dk, 1.269e07_dk,3.665e12_dk,8.281e10_dk,&
    &470._dk,6.107e11_dk, 2.996e13_dk,1.226e10_dk, 1.169e07_dk,3.635e12_dk,8.263e10_dk,&
    &472._dk,5.766e11_dk, 2.899e13_dk,1.148e10_dk, 1.077e07_dk,3.605e12_dk,8.245e10_dk,&
    &474._dk,5.445e11_dk, 2.806e13_dk,1.076e10_dk, 9.929e06_dk,3.576e12_dk,8.227e10_dk,&
    &476._dk,5.142e11_dk, 2.715e13_dk,1.007e10_dk, 9.149e06_dk,3.547e12_dk,8.209e10_dk,&
    &478._dk,4.855e11_dk, 2.628e13_dk,9.436e09_dk,8.432e06_dk,3.518e12_dk,8.191e10_dk,& 
    &480._dk,4.585e11_dk, 2.543e13_dk,8.839e09_dk,7.771e06_dk,3.489e12_dk,8.173e10_dk,& 
    &482._dk,4.330e11_dk, 2.461e13_dk,8.280e09_dk,7.162e06_dk,3.461e12_dk,8.155e10_dk,& 
                                                                      
    &484._dk,4.090e11_dk, 2.382e13_dk,7.757e09_dk,6.602e06_dk,3.432e12_dk,8.138e10_dk,& 
    &486._dk,3.863e11_dk, 2.306e13_dk,7.267e09_dk,6.085e06_dk,3.404e12_dk,8.120e10_dk,& 
    &488._dk,3.648e11_dk, 2.232e13_dk,6.808e09_dk,5.609e06_dk,3.377e12_dk,8.103e10_dk,& 
    &490._dk,3.446e11_dk, 2.160e13_dk,6.378e09_dk,5.171e06_dk,3.349e12_dk,8.085e10_dk,& 
    &492._dk,3.255e11_dk, 2.091e13_dk,5.976e09_dk,4.767e06_dk,3.322e12_dk,8.068e10_dk,& 
    &494._dk,3.075e11_dk, 2.024e13_dk,5.599e09_dk,4.395e06_dk,3.295e12_dk,8.051e10_dk,& 
    &496._dk,2.904e11_dk, 1.959e13_dk,5.247e09_dk,4.052e06_dk,3.268e12_dk,8.034e10_dk,& 
    &498._dk,2.744e11_dk, 1.896e13_dk,4.917e09_dk,3.737e06_dk,3.242e12_dk,8.017e10_dk,& 
    &500._dk,2.592e11_dk, 1.836e13_dk,4.607e09_dk,3.445e06_dk,3.215e12_dk,8.000e10_dk,& 
    &505._dk,2.249e11_dk, 1.693e13_dk,3.917e09_dk,2.814e06_dk,3.151e12_dk,7.959e10_dk,&  
                                                                      
    &510._dk,1.951e11_dk, 1.561e13_dk,3.331e09_dk,2.299e06_dk,3.087e12_dk,7.918e10_dk,& 
    &515._dk,1.694e11_dk, 1.440e13_dk,2.834e09_dk,1.878e06_dk,3.026e12_dk,7.878e10_dk,& 
    &520._dk,1.470e11_dk, 1.328e13_dk,2.411e09_dk,1.535e06_dk,2.965e12_dk,7.838e10_dk,& 
    &525._dk,1.277e11_dk, 1.225e13_dk,2.052e09_dk,1.255e06_dk,2.906e12_dk,7.798e10_dk,& 
    &530._dk,1.109e11_dk, 1.130e13_dk,1.747e09_dk,1.027e06_dk,2.848e12_dk,7.758e10_dk,& 
    &535._dk,9.633e10_dk, 1.043e13_dk,1.487e09_dk,8.400e05_dk,2.791e12_dk,7.719e10_dk,& 
    &540._dk,8.370e10_dk, 9.624e12_dk,1.267e09_dk,6.875e05_dk,2.735e12_dk,7.680e10_dk,& 
    &545._dk,7.274e10_dk, 8.883e12_dk,1.079e09_dk,5.628e05_dk,2.681e12_dk,7.641e10_dk,& 
    &550._dk,6.323e10_dk, 8.200e12_dk,9.196e08_dk,4.609e05_dk,2.628e12_dk,7.602e10_dk,& 
    &555._dk,5.497e10_dk, 7.570e12_dk,7.838e08_dk,3.775e05_dk,2.576e12_dk,7.564e10_dk,& 
                                                                      
    &560._dk,4.781e10_dk, 6.989e12_dk,6.682e08_dk,3.093e05_dk,2.525e12_dk,7.526e10_dk,& 
    &565._dk,4.158e10_dk, 6.454e12_dk,5.697e08_dk,2.535e05_dk,2.475e12_dk,7.488e10_dk,& 
    &570._dk,3.617e10_dk, 5.960e12_dk,4.859e08_dk,2.079e05_dk,2.426e12_dk,7.451e10_dk,& 
    &575._dk,3.148e10_dk, 5.505e12_dk,4.146e08_dk,1.705e05_dk,2.379e12_dk,7.413e10_dk,& 
    &580._dk,2.740e10_dk, 5.085e12_dk,3.537e08_dk,1.398e05_dk,2.332e12_dk,7.376e10_dk,& 
    &585._dk,2.385e10_dk, 4.698e12_dk,3.019e08_dk,1.147e05_dk,2.286e12_dk,7.339e10_dk,& 
    &590._dk,2.076e10_dk, 4.341e12_dk,2.578e08_dk,9.419e04_dk,2.241e12_dk,7.303e10_dk,& 
    &595._dk,1.808e10_dk, 4.011e12_dk,2.201e08_dk,7.733e04_dk,2.197e12_dk,7.267e10_dk,& 
    &600._dk,1.575e10_dk, 3.707e12_dk,1.880e08_dk,6.351e04_dk,2.154e12_dk,7.231e10_dk,& 
    &605._dk,1.372e10_dk, 3.426e12_dk,1.606e08_dk,5.217e04_dk,2.112e12_dk,7.195e10_dk,& 
                                                                      
    &610._dk,1.196e10_dk, 3.167e12_dk,1.372e08_dk,4.287e04_dk,2.071e12_dk,7.159e10_dk,& 
    &615._dk,1.042e10_dk, 2.928e12_dk,1.173e08_dk,3.524e04_dk,2.031e12_dk,7.124e10_dk,& 
    &620._dk,9.085e09_dk,2.707e12_dk,1.003e08_dk,2.898e04_dk,1.991e12_dk,7.089e10_dk,&  
    &625._dk,7.921e09_dk,2.503e12_dk,8.573e07_dk,2.383e04_dk,1.953e12_dk,7.054e10_dk,&  
    &630._dk,6.908e09_dk,2.315e12_dk,7.332e07_dk,1.961e04_dk,1.915e12_dk,7.019e10_dk,&  
    &635._dk,6.025e09_dk,2.141e12_dk,6.272e07_dk,1.612e04_dk,1.878e12_dk,6.985e10_dk,&  
    &640._dk,5.257e09_dk,1.981e12_dk,5.367e07_dk,1.328e04_dk,1.842e12_dk,6.950e10_dk,&  
    &645._dk,4.587e09_dk,1.832e12_dk,4.593e07_dk,1.094e04_dk,1.806e12_dk,6.916e10_dk,&  
    &650._dk,4.003e09_dk,1.695e12_dk,3.932e07_dk,9.006e03_dk,1.771e12_dk,6.883e10_dk,&  
    &655._dk,3.495e09_dk,1.569e12_dk,3.367e07_dk,7.420e03_dk,1.737e12_dk,6.849e10_dk,&  
                                                                      
    &660._dk,3.051e09_dk,1.452e12_dk,2.883e07_dk,6.114e03_dk,1.704e12_dk,6.816e10_dk,&  
    &665._dk,2.665e09_dk,1.344e12_dk,2.470e07_dk,5.040e03_dk,1.671e12_dk,6.782e10_dk,&  
    &670._dk,2.327e09_dk,1.244e12_dk,2.116e07_dk,4.155e03_dk,1.639e12_dk,6.749e10_dk,&  
    &675._dk,2.033e09_dk,1.151e12_dk,1.813e07_dk,3.427e03_dk,1.608e12_dk,6.717e10_dk,&  
    &680._dk,1.777e09_dk,1.066e12_dk,1.554e07_dk,2.827e03_dk,1.577e12_dk,6.684e10_dk,&  
    &685._dk,1.553e09_dk,9.870e11_dk, 1.333e07_dk,2.333e03_dk,1.547e12_dk,6.652e10_dk,& 
    &690._dk,1.357e09_dk,9.140e11_dk, 1.143e07_dk,1.926e03_dk,1.518e12_dk,6.620e10_dk,& 
    &695._dk,1.187e09_dk,8.465e11_dk, 9.802e06_dk,1.590e03_dk,1.489e12_dk,6.588e10_dk,& 
    &700._dk,1.038e09_dk,7.840e11_dk, 8.410e06_dk,1.313e03_dk,1.461e12_dk,6.556e10_dk,& 
    &705._dk,9.075e08_dk,7.263e11_dk, 7.216e06_dk,1.085e03_dk,1.433e12_dk,6.524e10_dk,& 
                                                                      
    &710._dk,7.939e08_dk,6.728e11_dk, 6.194e06_dk,8.964e02_dk,1.406e12_dk,6.493e10_dk,& 
    &715._dk,6.946e08_dk,6.234e11_dk, 5.317e06_dk,7.409e02_dk,1.379e12_dk,6.462e10_dk,& 
    &720._dk,6.078e08_dk,5.777e11_dk, 4.566e06_dk,6.126e02_dk,1.353e12_dk,6.431e10_dk,& 
    &725._dk,5.320e08_dk,5.354e11_dk, 3.921e06_dk,5.066e02_dk,1.328e12_dk,6.400e10_dk,& 
    &730._dk,4.658e08_dk,4.962e11_dk, 3.368e06_dk,4.191e02_dk,1.303e12_dk,6.370e10_dk,& 
    &735._dk,4.078e08_dk,4.599e11_dk, 2.894e06_dk,3.467e02_dk,1.278e12_dk,6.339e10_dk,& 
    &740._dk,3.572e08_dk,4.264e11_dk, 2.487e06_dk,2.870e02_dk,1.254e12_dk,6.309e10_dk,& 
    &745._dk,3.129e08_dk,3.953e11_dk, 2.138e06_dk,2.376e02_dk,1.231e12_dk,6.279e10_dk,& 
    &750._dk,2.741e08_dk,3.666e11_dk, 1.838e06_dk,1.967e02_dk,1.208e12_dk,6.249e10_dk,& 
    &755._dk,2.402e08_dk,3.399e11_dk, 1.581e06_dk,1.630e02_dk,1.185e12_dk,6.220e10_dk,& 
                                                                      
    &760._dk,2.105e08_dk,3.153e11_dk, 1.360e06_dk,1.350e02_dk,1.163e12_dk,6.190e10_dk,& 
    &765._dk,1.845e08_dk,2.924e11_dk, 1.170e06_dk,1.119e02_dk,1.141e12_dk,6.161e10_dk,& 
    &770._dk,1.618e08_dk,2.712e11_dk, 1.007e06_dk,9.276e01_dk,1.120e12_dk,6.132e10_dk,& 
    &775._dk,1.419e08_dk,2.516e11_dk, 8.664e05_dk,7.692e01_dk,1.099e12_dk,6.103e10_dk,& 
    &780._dk,1.244e08_dk,2.335e11_dk, 7.458e05_dk,6.380e01_dk,1.079e12_dk,6.074e10_dk,& 
    &785._dk,1.092e08_dk,2.166e11_dk, 6.422e05_dk,5.293e01_dk,1.059e12_dk,6.046e10_dk,& 
    &790._dk,9.577e07_dk,2.011e11_dk, 5.531e05_dk,4.392e01_dk,1.039e12_dk,6.017e10_dk,& 
    &795._dk,8.404e07_dk,1.866e11_dk, 4.764e05_dk,3.646e01_dk,1.020e12_dk,5.989e10_dk,& 
    &800._dk,7.377e07_dk,1.732e11_dk, 4.105e05_dk,3.027e01_dk,1.001e12_dk,5.961e10_dk,& 
    &805._dk,6.476e07_dk,1.608e11_dk, 3.537e05_dk,2.514e01_dk,9.826e11_dk, 5.933e10_dk,& 
                                                                      
    &810._dk,5.686e07_dk,1.493e11_dk, 3.049e05_dk,2.088e01_dk,9.645e11_dk, 5.905e10_dk,&
    &815._dk,4.993e07_dk,1.386e11_dk, 2.628e05_dk,1.735e01_dk,9.468e11_dk, 5.878e10_dk,&
    &820._dk,4.386e07_dk,1.287e11_dk, 2.267e05_dk,1.442e01_dk,9.294e11_dk, 5.851e10_dk,&
    &825._dk,3.853e07_dk,1.195e11_dk, 1.955e05_dk,1.199e01_dk,9.124e11_dk, 5.823e10_dk,&
    &830._dk,3.386e07_dk,1.110e11_dk, 1.686e05_dk,9.970e00_dk,8.957e11_dk, 5.796e10_dk,&
    &835._dk,2.975e07_dk,1.031e11_dk, 1.455e05_dk,8.293e00_dk,8.793e11_dk, 5.769e10_dk,&
    &840._dk,2.615e07_dk,9.580e10_dk, 1.256e05_dk,6.900e00_dk,8.632e11_dk, 5.743e10_dk,&
    &845._dk,2.299e07_dk,8.901e10_dk, 1.084e05_dk,5.742e00_dk,8.475e11_dk, 5.716e10_dk,&
    &850._dk,2.022e07_dk,8.270e10_dk, 9.358e04_dk,4.780e00_dk,8.320e11_dk, 5.690e10_dk,&
    &855._dk,1.778e07_dk,7.685e10_dk, 8.081e04_dk,3.980e00_dk,8.169e11_dk, 5.664e10_dk,&
                                                                      
    &860._dk,1.564e07_dk,7.142e10_dk, 6.979e04_dk,3.314e00_dk,8.021e11_dk, 5.637e10_dk,&
    &865._dk,1.376e07_dk,6.638e10_dk, 6.029e04_dk,2.761e00_dk,7.875e11_dk, 5.612e10_dk,&
    &870._dk,1.211e07_dk,6.171e10_dk, 5.210e04_dk,2.301e00_dk,7.733e11_dk, 5.586e10_dk,&
    &875._dk,1.066e07_dk,5.737e10_dk, 4.503e04_dk,1.918e00_dk,7.593e11_dk, 5.560e10_dk,&
    &880._dk,9.380e06_dk,5.334e10_dk, 3.892e04_dk,1.599e00_dk,7.456e11_dk, 5.535e10_dk,&
    &885._dk,8.258e06_dk,4.959e10_dk, 3.365e04_dk,1.333e00_dk,7.321e11_dk, 5.509e10_dk,&
    &890._dk,7.271e06_dk,4.612e10_dk, 2.910e04_dk,1.112e00_dk,7.189e11_dk, 5.484e10_dk,&
    &895._dk,6.404e06_dk,4.289e10_dk, 2.517e04_dk,9.277e-1_dk,7.060e11_dk, 5.459e10_dk,&
    &900._dk,5.641e06_dk,3.989e10_dk, 2.177e04_dk,7.742e-1_dk,6.933e11_dk, 5.434e10_dk,&
    &905._dk,4.970e06_dk,3.711e10_dk, 1.884e04_dk,6.462e-1_dk,6.809e11_dk, 5.410e10_dk,&
                                                                      
    &910._dk,4.379e06_dk,3.452e10_dk, 1.631e04_dk,5.396e-1_dk,6.687e11_dk, 5.385e10_dk,&
    &915._dk,3.859e06_dk,3.212e10_dk, 1.411e04_dk,4.506e-1_dk,6.567e11_dk, 5.361e10_dk,&
    &920._dk,3.402e06_dk,2.989e10_dk, 1.222e04_dk,3.764e-1_dk,6.450e11_dk, 5.336e10_dk,&
    &925._dk,2.999e06_dk,2.781e10_dk, 1.058e04_dk,3.145e-1_dk,6.335e11_dk, 5.312e10_dk,&
    &930._dk,2.645e06_dk,2.588e10_dk, 9.165e03_dk,2.629e-1_dk,6.222e11_dk, 5.288e10_dk,&
    &935._dk,2.332e06_dk,2.409e10_dk, 7.940e03_dk,2.197e-1_dk,6.111e11_dk, 5.264e10_dk,&
    &940._dk,2.057e06_dk,2.242e10_dk, 6.880e03_dk,1.837e-1_dk,6.003e11_dk, 5.241e10_dk,&
    &945._dk,1.815e06_dk,2.088e10_dk, 5.962e03_dk,1.537e-1_dk,5.896e11_dk, 5.217e10_dk,&
    &950._dk,1.602e06_dk,1.944e10_dk, 5.168e03_dk,1.286e-1_dk,5.792e11_dk, 5.194e10_dk,&
    &955._dk,1.414e06_dk,1.810e10_dk, 4.481e03_dk,1.076e-1_dk,5.689e11_dk, 5.170e10_dk,& 
                                                                      
    &960._dk,1.248e06_dk,1.685e10_dk, 3.886e03_dk,9.004e-2_dk,5.589e11_dk, 5.147e10_dk,&
    &965._dk,1.102e06_dk,1.569e10_dk, 3.370e03_dk,7.538e-2_dk,5.490e11_dk, 5.124e10_dk,&
    &970._dk,9.726e05_dk,1.462e10_dk, 2.924e03_dk,6.312e-2_dk,5.393e11_dk, 5.101e10_dk,&
    &975._dk,8.590e05_dk,1.362e10_dk, 2.537e03_dk,5.287e-2_dk,5.298e11_dk, 5.078e10_dk,&
    &980._dk,7.587e05_dk,1.268e10_dk, 2.201e03_dk,4.430e-2_dk,5.205e11_dk, 5.056e10_dk,&
    &985._dk,6.703e05_dk,1.182e10_dk, 1.911e03_dk,3.712e-2_dk,5.114e11_dk, 5.033e10_dk,&
    &990._dk,5.922e05_dk,1.101e10_dk, 1.659e03_dk,3.111e-2_dk,5.024e11_dk, 5.011e10_dk,&
    &995._dk,5.234e05_dk,1.026e10_dk, 1.440e03_dk,2.609e-2_dk,4.936e11_dk, 4.989e10_dk,&
    &1000._dk,4.626e05_dk,9.562e09_dk,1.251e03_dk,2.188e-2_dk,4.850e11_dk, 4.967e10_dk,&
    &1000._dk,0._dk    ,0._dk    ,0._dk    ,0._dk     ,0._dk    ,0._dk&
    &],[7,430])

public  ::  US76_UPPER

contains




subroutine US76_UPPER(z,temp76,press76,dens76)
! Description:
!    Density for the upper atmosphere (z >= 86 km) from the US 1976 Reference
!    atmosphere. This implementation is a Fortran port of the one contained in
!    the Java code PATRIUS 3.4.1 by CNES. The atmosphere is defined up to
!    z = 1000 km, and density should be set to zero afterwards.
! 
! Author:
!    Davide Amato
!    Technical University of Madrid (UPM)
!    davideamato@email.arizona.edu
! 
! References:
!    [1] Technical Report NASA-TM-X-7433b, "U.S. Standard Atmosphere 1976",
!        1976.
!    [2] https://logiciels.cnes.fr/fr/content/patrius, last accessed 05/10/2017.
! 
! History:
!    [1] 
! 
! ==============================================================================

! VARIABLES
implicit none
! Inputs
real(dk),intent(in)   ::  z        ! Altitude [km]
real(dk),intent(out)  ::  temp76   ! Local temperature [K]
real(dk),intent(out)  ::  press76  ! Local pressure    [Pa]
real(dk),intent(out)  ::  dens76   ! Local density     [kg/m^3]

! Locals
real(dk)  ::  rcar              ! Auxiliary variable
real(dk)  ::  xi                ! Exponent for layer D
real(dk)  ::  slope             ! Interpolation slope
real(dk)  ::  xmol              ! Molar mass [g/mol]
real(dk)  ::  rnn               ! Number density for each of the species [m^-3]
real(dk)  ::  rn                ! Total number density [m^-3]
integer   ::  indexAtmo         ! Int index of the atmospheric layer in nAtmo
integer   ::  l                 ! Int index of the species


! ==============================================================================

! ==============================================================================
! 01. TEMPERATURE AS A FUNCTION OF THE ALTITUDE
! ==============================================================================

if (z < zLayer_91km) then
  ! A. Isothermal layer
  temp76 = temp_91km

else if (z < zLayer_110km) then
  ! B. "Elliptic" temperature layer (see [1], eq. (27))
  rcar   = sqrt(1._dk - ((z - zLayer_91km)/pta)**2)
  temp76 = tc + gda * rcar

else if (z < zLayer_120km) then
  ! C. Positive-gradient layer (see [1], eq. (29))
  temp76 = temp_110km + dt_110km * (z - zLayer_110km)

else
  ! D. Exponential layer (see [1], eq. (31))
  xi = (z - zLayer_120km) * (AE + zLayer_120km) / (AE + z)
  temp76 = temp_1000km - (temp_1000km - temp_120km) * exp(-rlambda * xi)

end if

indexAtmo = GET_ATMO_INDEX(z)

! ==============================================================================
! 02. AVERAGE MOLAR MASS AND PRESSURE
! ==============================================================================

! The number density for each of the species at altitude 'z' is computed by
! interpolating nAtmo linearly.
slope = 0._dk
xmol  = 0._dk
rn    = 0._dk
do l=2,6
  slope = (nAtmo(l,indexAtmo + 1) - nAtmo(l,indexAtmo))/&
         &(nAtmo(1,indexAtmo + 1) - nAtmo(1,indexAtmo))
  rnn   = nAtmo(l,indexAtmo) + slope * (z - nAtmo(1,indexAtmo))  ! Number density of species 'l'
  xmol  = xmol + rnn * molmass(l)  ! Molar mass of species l
  rn    = rn + rnn                 ! Update total number density

end do
xmol = xmol/rn                     ! Average molar mass
press76 = rn * boltz * temp76      ! Pressure

! ==============================================================================
! 03. DENSITY
! ==============================================================================

dens76 = press76 * xmol / (rstar * temp76)


end subroutine US76_UPPER




function GET_ATMO_INDEX(z)
! Description:
!    Gets the index of the nAtmo array corresponding to the maximum altitude <=
!    z.
! 
! History:
! 20180307, DA: The exponent slope is now fixed to that at 1000km for higher
!               altitudes.
! 
! ==============================================================================

! VARIABLES
implicit none
! Inputs
real(dk)  ::  z    ! Altitude [km]
! Function definition
integer   ::  GET_ATMO_INDEX
integer   ::  k

! ==============================================================================

k = 1
GET_ATMO_INDEX = k
do while (z > nAtmo(1,k) .and. k < (size(nAtmo,2) - 1) )
  GET_ATMO_INDEX = k
  k = k + 1

end do


end function GET_ATMO_INDEX

end module US76_PATRIUS